'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _dotenv=require('dotenv'),_dotenv2=_interopRequireDefault(_dotenv),_express=require('express'),_express2=_interopRequireDefault(_express),_multer=require('multer'),_multer2=_interopRequireDefault(_multer),_bodyParser=require('body-parser'),_bodyParser2=_interopRequireDefault(_bodyParser),_requestHandler=require('./helpers/request-handler'),_requestHandler2=_interopRequireDefault(_requestHandler);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var RequestHandler=_requestHandler2.default.RequestHandler;_dotenv2.default.config();var NODE_ENV=process.env.NODE_ENV,app=(0,_express2.default)();if(NODE_ENV==='PROD'){app.set('PORT',process.env.PORT_PROD)}else if(NODE_ENV==='DEV'){app.set('PORT',process.env.PORT_DEV)}else{app.set('PORT',process.env.PORT_TEST)}app.use(_bodyParser2.default.json());app.use(_bodyParser2.default.urlencoded({extended:!1}));var uploadPath=process.cwd()+'/dist/uploads',storage=_multer2.default.diskStorage({destination:(a,b,c)=>{c(null,uploadPath)},filename:(a,b,c)=>{c(null,b.originalname)}}),upload=(0,_multer2.default)({storage:storage});app.use(upload.array('files',5));app.post('/api/create',(a,b)=>{RequestHandler.handleCreate(a,b)});app.post('/api/search',(a,b)=>{RequestHandler.handleSearch(a,b)});var port=app.get('PORT'),server=app.listen(process.env.PORT||port);exports.default=server;